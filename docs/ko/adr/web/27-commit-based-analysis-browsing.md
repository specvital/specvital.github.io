---
title: ì»¤ë°‹ ê¸°ë°˜ ë¶„ì„ ì¡°íšŒ
description: ê³¼ê±° ë¶„ì„ ê¸°ë¡ íƒìƒ‰ì„ ìœ„í•œ URL ê¸°ë°˜ ì»¤ë°‹ ì„ íƒ ADR
---

# ADR-27: ì»¤ë°‹ ê¸°ë°˜ ë¶„ì„ ì¡°íšŒ

> ğŸ‡ºğŸ‡¸ [English Version](/en/adr/web/27-commit-based-analysis-browsing.md)

| ë‚ ì§œ       | ì‘ì„±ì       | ë¦¬í¬ì§€í† ë¦¬ |
| ---------- | ------------ | ---------- |
| 2026-02-03 | @KubrickCode | web        |

## Context

### ë¬¸ì œ ìƒí™©

ì‚¬ìš©ìëŠ” ë¦¬í¬ì§€í† ë¦¬ì˜ ìµœì‹  ë¶„ì„ ê²°ê³¼ë§Œ ì¡°íšŒ ê°€ëŠ¥. ê·¸ëŸ¬ë‚˜ ë°ì´í„°ë² ì´ìŠ¤ì—ëŠ” íŠ¹ì • ì»¤ë°‹ SHAì— ì—°ê²°ëœ ì—¬ëŸ¬ ë¶„ì„ ê¸°ë¡ ì¡´ì¬. force-push ì‘ì—…(`git reset --hard && git push -f`) í›„ "Up to date" ë©”ì‹œì§€ë§Œ í‘œì‹œë˜ê³ , ì´ì „ì— ë¶„ì„ëœ ì»¤ë°‹ ì ‘ê·¼ ë¶ˆê°€.

### ì‚¬ìš©ì ìš”êµ¬ì‚¬í•­

| ìš”êµ¬ì‚¬í•­              | ì„¤ëª…                                |
| --------------------- | ----------------------------------- |
| íˆìŠ¤í† ë¦¬ ì¡°íšŒ         | ì´ì „ì— ë¶„ì„ëœ ëª¨ë“  ì»¤ë°‹ì˜ ê²°ê³¼ ì¡°íšŒ |
| ì‹œê°„ë³„ ë¹„êµ           | í…ŒìŠ¤íŠ¸ ëª…ì„¸ ë³€í™” ì¶”ì                |
| íšŒê·€ ë””ë²„ê¹…           | íŠ¹ì • í…ŒìŠ¤íŠ¸ ëª…ì„¸ ë³€ê²½ ì‹œì  ì‹ë³„     |
| ê³µìœ  ê°€ëŠ¥í•œ ë¶„ì„ ìƒíƒœ | íŠ¹ì • ì»¤ë°‹ ë¶„ì„ ê²°ê³¼ ë§í¬ ê³µìœ        |

### ê¸°ì¡´ ì œì•½ì‚¬í•­

| ì œì•½ì‚¬í•­           | ì¶œì²˜       | ì˜í–¥                                     |
| ------------------ | ---------- | ---------------------------------------- |
| nuqs URL ìƒíƒœ      | Web ADR-16 | ì»¤ë°‹ ì„ íƒì— URL íŒŒë¼ë¯¸í„° ì‚¬ìš© í•„ìš”       |
| Zustand ë²”ìœ„       | Web ADR-26 | ì„ì‹œ ìƒíƒœ ì „ìš©; ë„¤ë¹„ê²Œì´ì…˜ ìƒíƒœì— ë¶€ì í•© |
| TanStack Query     | Web ADR-04 | ë¶„ì„ ë°ì´í„° fetching íŒ¨í„´ í™•ë¦½           |
| Next.js App Router | Web ADR-07 | URL ìƒíƒœì— ëŒ€í•œ SSR ê³ ë ¤ í•„ìš”            |

## Decision

**nuqsë¥¼ ì‚¬ìš©í•œ URL ê¸°ë°˜ ì»¤ë°‹ ì„ íƒê³¼ CommitSelector UI ì»´í¬ë„ŒíŠ¸ ë„ì….**

í•µì‹¬ ì›ì¹™:

1. **URLì„ ì§„ì‹¤ì˜ ì›ì²œìœ¼ë¡œ**: ì»¤ë°‹ ì„ íƒì´ URLì— ìœ ì§€ (`?commit=abc1234`)
2. **ì ì§„ì  ê°œì„ **: íŒŒë¼ë¯¸í„° ì—†ì„ ì‹œ ìµœì‹  ì»¤ë°‹ìœ¼ë¡œ ê¸°ë³¸ ì„¤ì •
3. **nuqs í†µí•©**: SHA í˜•ì‹ ê²€ì¦ê³¼ í•¨ê»˜ `parseAsString` ì‚¬ìš©
4. **ë³µí•© ìƒíƒœ**: ì»¤ë°‹ ì„ íƒê³¼ ê¸°ì¡´ í•„í„° ì¡°í•©

### URL êµ¬ì¡°

```
/repos/{owner}/{repo}/analysis?commit=abc1234
/repos/{owner}/{repo}/analysis?commit=abc1234&view=starred&q=auth
```

## Options Considered

### Option A: nuqsë¥¼ í†µí•œ URL ê¸°ë°˜ ì»¤ë°‹ ì„ íƒ (ì±„íƒ)

ê¸°ì¡´ nuqs íŒ¨í„´ì„ ì‚¬ìš©í•˜ì—¬ ì„ íƒëœ ì»¤ë°‹ SHAë¥¼ URL ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ì— ì €ì¥.

**ì¥ì :**

- ì •í™•í•œ ë¶„ì„ ìƒíƒœë¥¼ ë‹´ì€ ê³µìœ  ê°€ëŠ¥í•œ URL
- ë¸Œë¼ìš°ì € íˆìŠ¤í† ë¦¬ í†µí•© (ë’¤ë¡œ/ì•ìœ¼ë¡œ ë„¤ë¹„ê²Œì´ì…˜)
- SSR í˜¸í™˜ìœ¼ë¡œ ì‚¬ì „ fetching ê°€ëŠ¥
- ê¸°ì¡´ í•„í„° íŒ¨í„´ê³¼ ì¼ê´€ì„± (ADR-16)
- ë‹¤ë¥¸ URL ìƒíƒœì™€ ì¡°í•© ê°€ëŠ¥

**ë‹¨ì :**

- URL ê¸¸ì´ ì¦ê°€ (7ì SHA ì¶•ì•½ìœ¼ë¡œ ì™„í™”)
- ìœ íš¨í•˜ì§€ ì•Šì€ ì»¤ë°‹ ì²˜ë¦¬ í•„ìš”
- ì»¤ë°‹ ì‚­ì œ ì‹œ ì˜¤ë˜ëœ ë¶ë§ˆí¬ ì²˜ë¦¬ í•„ìš”

### Option B: Zustandë¥¼ í†µí•œ í´ë¼ì´ì–¸íŠ¸ ì¸¡ ìƒíƒœ

ì„ íƒëœ ì»¤ë°‹ì„ ì„ì‹œ í´ë¼ì´ì–¸íŠ¸ ìƒíƒœë¡œ Zustand ìŠ¤í† ì–´ì— ì €ì¥.

**ì¥ì :**

- ê¹”ë”í•œ URL
- ë¹ ë¥¸ ìƒíƒœ ë³€ê²½
- í¬ë¡œìŠ¤ ì»´í¬ë„ŒíŠ¸ ì ‘ê·¼

**ë‹¨ì :**

- ê³µìœ  ë¶ˆê°€
- í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì‹œ ìƒíƒœ ì†ì‹¤
- ë¸Œë¼ìš°ì € íˆìŠ¤í† ë¦¬ ë¯¸ì§€ì›
- ADR-26 ë²”ìœ„ ìœ„ë°˜ (ZustandëŠ” ì„ì‹œ ìƒíƒœ ì „ìš©)

**ê¸°ê°**: í™•ë¦½ëœ íŒ¨í„´ê³¼ ëª¨ìˆœ; ê³µìœ  ê°€ëŠ¥í•œ ë§í¬ì— ëŒ€í•œ ë¶ˆëŸ‰ UX.

### Option C: ê²½ë¡œ ì„¸ê·¸ë¨¼íŠ¸ ê¸°ë°˜ ì„ íƒ

ì»¤ë°‹ SHAë¥¼ URL ê²½ë¡œì— ì¸ì½”ë”© (`/analysis/{commit}`).

**ì¥ì :**

- RESTful ì‹œë§¨í‹±
- ê¹”ë”í•œ URL ê³„ì¸µ êµ¬ì¡°

**ë‹¨ì :**

- ë¼ìš°íŒ… ë³µì¡ì„± ì¦ê°€
- ì¿¼ë¦¬ ê¸°ë°˜ í•„í„°ì™€ ë¶ˆì¼ì¹˜
- ì»´í¬ë„ŒíŠ¸ ì—…ë°ì´íŠ¸ê°€ ì•„ë‹Œ í˜ì´ì§€ ì „í™˜ ë°œìƒ

**ê¸°ê°**: êµ¬í˜„ ë…¸ë ¥ ì¦ê°€; í•„í„° ì¡°í•© ë¶ˆê°€.

### Option D: ë“œë¡­ë‹¤ìš´ë§Œ (ìƒíƒœ ì§€ì†ì„± ì—†ìŒ)

ë¡œì»¬ ìƒíƒœë§Œ ìˆëŠ” UI ì»´í¬ë„ŒíŠ¸.

**ê¸°ê°**: ìˆ˜ìš© ë¶ˆê°€í•œ UX; ëª¨ë“  ë„¤ë¹„ê²Œì´ì…˜ì—ì„œ ì„ íƒ ì†ì‹¤.

## Implementation Details

### API ì—”ë“œí¬ì¸íŠ¸

| ì—”ë“œí¬ì¸íŠ¸                                     | ëª©ì                          |
| ---------------------------------------------- | ---------------------------- |
| `GET /api/analyze/{owner}/{repo}/history`      | ë¶„ì„ëœ ì»¤ë°‹ ëª©ë¡ (ìµœëŒ€ 50ê°œ) |
| `GET /api/analyze/{owner}/{repo}?commit={sha}` | íŠ¹ì • ì»¤ë°‹ì˜ ë¶„ì„ ê²°ê³¼ ì¡°íšŒ   |

### ë°ì´í„° êµ¬ì¡°

```typescript
interface AnalysisHistoryItem {
  id: string;
  commitSha: string;
  commitDate: string | null;
  completedAt: string;
  branchName: string | null;
  testCount: number;
  isHead: boolean;
}
```

### URL ìƒíƒœ Hook

```typescript
import { parseAsString, useQueryState } from "nuqs";

const commitParser = parseAsString.withDefault("");

export const useCommitSelect = () => {
  const [commit, setCommit] = useQueryState("commit", commitParser);
  const validated = /^[a-f0-9]{7,40}$/.test(commit ?? "") ? commit : null;
  return { commit: validated, setCommit } as const;
};
```

### CommitSelector ì»´í¬ë„ŒíŠ¸

- ì¶•ì•½ëœ SHA (7ì) í‘œì‹œ ë“œë¡­ë‹¤ìš´
- í˜„ì¬ HEAD ì»¤ë°‹ì— `[HEAD]` ë°°ì§€
- í…ŒìŠ¤íŠ¸ ìˆ˜, ë¸Œëœì¹˜ëª…, ë‚ ì§œ í‘œì‹œ
- íˆìŠ¤í† ë¦¬ í•­ëª©ì´ 2ê°œ ë¯¸ë§Œì¼ ê²½ìš° ì •ì  í…ìŠ¤íŠ¸ë¡œ í´ë°±

### TanStack Query í†µí•©

```typescript
export const useAnalysisData = (owner: string, repo: string) => {
  const { commit } = useCommitSelect();

  return useQuery({
    queryKey: ["analysis", owner, repo, commit],
    queryFn: () => fetchAnalysis(owner, repo, commit),
  });
};
```

## Consequences

### Positive

- **ê³µìœ  ê°€ëŠ¥í•œ ë¶„ì„ ìƒíƒœ**: `/analysis?commit=abc1234&view=starred` ê°™ì€ URLë¡œ í˜‘ì—… ê°€ëŠ¥
- **ë¸Œë¼ìš°ì € ë„¤ë¹„ê²Œì´ì…˜**: ë’¤ë¡œ/ì•ìœ¼ë¡œ ë²„íŠ¼ìœ¼ë¡œ ì»¤ë°‹ íˆìŠ¤í† ë¦¬ ìì—°ìŠ¤ëŸ½ê²Œ íƒìƒ‰
- **SSR ìµœì í™”**: URL íŒŒë¼ë¯¸í„°ì—ì„œ ì„œë²„ê°€ ì˜¬ë°”ë¥¸ ë¶„ì„ ì‚¬ì „ fetch ê°€ëŠ¥
- **íŒ¨í„´ ì¼ê´€ì„±**: ADR-16ì˜ nuqs íŒ¨í„´ í™•ì¥
- **ë””ë²„ê¹… ìš©ì´ì„±**: ì§€ì›íŒ€ì´ ì •í™•í•œ ìƒíƒœë¥¼ ìœ„í•´ "URL ë³´ë‚´ì£¼ì„¸ìš”" ìš”ì²­ ê°€ëŠ¥

### Negative

- **URL ë³µì¡ì„±**: ì»¤ë°‹ íŒŒë¼ë¯¸í„°ë¡œ URL ê¸¸ì–´ì§ (SHA ì¶•ì•½ìœ¼ë¡œ ì™„í™”)
- **ìœ íš¨í•˜ì§€ ì•Šì€ ìƒíƒœ ì²˜ë¦¬**: ì‚­ì œëœ/ì‚¬ìš© ë¶ˆê°€í•œ ì»¤ë°‹ ìš°ì•„í•˜ê²Œ ì²˜ë¦¬ í•„ìš”
- **ì¿¼ë¦¬ ë¬´íš¨í™”**: ì»¤ë°‹ ë³€ê²½ ì‹œ TanStack Query ìºì‹œ ë¬´íš¨í™” (ì˜ˆìƒëœ ë™ì‘)

## References

### Internal

- [ADR-04: TanStack Query ì„ íƒ](/ko/adr/web/04-tanstack-query-selection.md) - ì„œë²„ ìƒíƒœ ê´€ë¦¬
- [ADR-16: nuqs URL ìƒíƒœ ê´€ë¦¬](/ko/adr/web/16-nuqs-url-state-management.md) - URL ìƒíƒœ íŒ¨í„´
- [ADR-26: Zustand í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ ê´€ë¦¬](/ko/adr/web/26-zustand-client-state.md) - ìƒíƒœ ê´€ë¦¬ ì‚¼ìœ„ì¼ì²´
- [ADR-12: Worker ì¤‘ì‹¬ ë¶„ì„ ë¼ì´í”„ì‚¬ì´í´](/ko/adr/12-worker-centric-analysis-lifecycle.md) - ë¶„ì„ ë°ì´í„° ëª¨ë¸

### External

- [GitHub Issue #300](https://github.com/specvital/web/issues/300) - ê¸°ëŠ¥ ìš”ì²­ ë° ì„¤ê³„
- [Release v1.6.0](https://github.com/specvital/web/releases/tag/v1.6.0) - ì´ˆê¸° êµ¬í˜„
